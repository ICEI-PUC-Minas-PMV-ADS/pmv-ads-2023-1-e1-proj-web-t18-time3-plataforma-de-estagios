<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./curriculo.css">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./src/assets/css/empresas.css">
    <title>Empresa</title>
</head>
<body>
    <div id="container">
        <div id="topo">
            
            <div class="header">
            <div class="logo">
                <h1 class="logo">Primeiro Estagio</h1>
            </div>
            <ul id="navegao">
                <li><a href="index.html">Home</a></li>
                <li><a href="empresa.html">Empresa</a></li>
                <li><a href="LGPD.html">LGPD</a></li>
                <li><a href="fale-conosco.html">Fale Conosco</a></li>
            </ul>
        </div>
        </div>

    <br>
        <form action="#" method="get" autocomplete="off" class="for">
            <fieldset class="form__fieldset">
                <legend class="form__title">Cadastre sua empresa</legend>
                
                <label for="nome" class="form__label">Nome da instituição</label>
                <input type="text" id="nome" name="nome" class="form__input">
    
                <label for="descricao" class="form__label">Descrição</label>
                <input type="text" id="descricao" name="email" class="form__input">
                
                <div class="form__action">
                <button class="btns" type="button" onclick="adicionarEmpresa()">Cadastro</button>
                <button class="btns" type="button" onclick="exibirDados()">Atualizar</button>
                </div>

            </fieldset>

            <div id="dados"></div>
            <div id="container-formulario"></div>
            
        </form> 

        <script>
            var nome = '';
            var descricao = '';

            localStorage.setItem("empresas", JSON.stringify([]));

            var empresa = { "nome": nome, "descricao": descricao};
            console.log(empresa);

            function adicionarEmpresa(){
                nome = document.getElementById("nome").value;
	            descricao = document.getElementById("descricao").value;

                var empresa = { "nome": nome, "descricao": descricao};
                console.log(empresa);

                var empresasJSON = JSON.parse(localStorage.getItem("empresas"));
                console.log(empresasJSON);

                empresasJSON.push(empresa);
                console.log(empresasJSON);

                localStorage.setItem("empresas", JSON.stringify(empresasJSON));
            }

            function exibirDados() {
              var empresasJSON = JSON.parse(localStorage.getItem("empresas")) || [];

              var lista = document.createElement("ul");
              for (var i = 0; i < empresasJSON.length; i++) {
              var empresa = empresasJSON[i];
              var itemLista = document.createElement("li");
              itemLista.classList.add("empresas");

              // Cria o elemento de texto
              var textoElemento = document.createElement("div");
              textoElemento.innerHTML = "<strong>Nome:</strong> <div>" + empresa.nome + "</div> <strong>Descrição:</strong><div>" + empresa.descricao +"</div>";
              itemLista.appendChild(textoElemento);

              // Cria o botão "Editar"
              var botaoEditar = document.createElement("button");
              botaoEditar.classList.add("btns");
              botaoEditar.innerHTML = "Editar";

              botaoEditar.setAttribute("data-index", i);
              botaoEditar.addEventListener("click", function() {
              var index = this.getAttribute("data-index");
              var empresa = empresasJSON[index];
              exibirFormulario(empresa, index);
              });
              itemLista.appendChild(botaoEditar);

              // Cria o botão "Deletar"
              var botaoDeletar = document.createElement("button");
              botaoDeletar.classList.add("btns");
              botaoDeletar.innerHTML = "Deletar";
              botaoDeletar.setAttribute("data-index", i);
              botaoDeletar.addEventListener("click", function() {
              var index = this.getAttribute("data-index");
              empresasJSON.splice(index, 1);
              localStorage.setItem("empresas", JSON.stringify(empresasJSON));
              exibirDados();
              });
              itemLista.appendChild(botaoDeletar);

              lista.appendChild(itemLista);
              }

              var dadosElemento = document.getElementById("dados");
              dadosElemento.innerHTML = "";
              dadosElemento.appendChild(lista);
              }

              function exibirFormulario(empresa, index) {
              var formulario = document.createElement("form");
              formulario.classList.add("atualiza");

              // Cria o campo "Nome"
              var campoNome = document.createElement("div");
              campoNome.innerHTML = "<label>Nome:</label><input type='text' id='campoNome' name='nome' value='" + empresa.nome + "' required />";
              formulario.appendChild(campoNome);

              // Cria o campo "descricao"
              var campodescricao = document.createElement("div");
              campodescricao.innerHTML = "<label>descricao:</label><input type='text' id='campodescricao' name='descricao' value='" + empresa.descricao + "' required />";
              formulario.appendChild(campodescricao);


              // Cria o botão "Salvar"
              var botaoSalvar = document.createElement("input");
              botaoSalvar.type = "submit";
              botaoSalvar.value = "Salvar";
              formulario.appendChild(botaoSalvar);

              // Adiciona o formulário ao elemento HTML
              var containerFormulario = document.getElementById("container-formulario");
              containerFormulario.appendChild(formulario);

              // Adiciona o evento de escuta para o evento "submit" do formulário
              formulario.addEventListener("submit", function(event) {
              event.preventDefault();

              // Obter os valores dos campos do formulário
              var nome = document.getElementById("campoNome").value;
              var descricao = document.getElementById("campodescricao").value;

              // Criar um empresa com esses valores
              var empresa = { "nome": nome, "descricao": descricao};
              console.log(empresa);

              // Obter o array de empresas do localStorage
              var empresasJSON = JSON.parse(localStorage.getItem("empresas"));

              // Adicionar o empresa ao array de empresas
              empresasJSON[index] = empresa;

              // Salvar o array de empresas no localStorage como um arquivo JSON
              localStorage.setItem("empresas", JSON.stringify(empresasJSON));

              formulario.remove();

              });

              exibirDados();


            }

            </script>
</body>
<br><br>
</html>